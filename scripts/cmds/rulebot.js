module.exports = {
    config: {
        name: "rulebot",
        aliases: [],
        version: "1.0.1",
        author: "ЁЭР┤ЁЭСаЁЭСЦЁЭСУ ЁЭСАЁЭСОтДОЁЭСЪЁЭСвЁЭСС",
        countDown: 5,
        role: 0,
        category: "ЁЭСФЁЭСЯЁЭСЬЁЭСвЁЭСЭ",
        shortDescription: {
            en: "ржмржЯ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржирж┐ржпрж╝ржо ЁЯУЭ",
            bn: "ржмржЯ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржирж┐ржпрж╝ржо ЁЯУЭ"
        },
        longDescription: {
            en: "Displays the rules for using the chatbot",
            bn: "ржЪрзНржпрж╛ржЯржмржЯ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржирж┐ржпрж╝ржорж╛ржмрж▓рзА ржжрзЗржЦрж╛ржпрж╝"
        },
        guide: {
            en: "{p}rulebot",
            bn: "{p}rulebot ржмрж╛ {p}ржмржЯржирж┐ржпрж╝ржо"
        }
    },

    onStart: async function({ message, event }) {
        try {
            console.log(`ЁЯУЭ ЁЭСЕЁЭСвЁЭСЩЁЭСТЁЭСПЁЭСЬЁЭСб ЁЭСРЁЭСОЁЭСЩЁЭСЩЁЭСТЁЭСС ЁЭСПЁЭСж ЁЭСвЁЭСаЁЭСТЁЭСЯ: ${event.senderID}`);
            
            const rulesMessage = `ЁЯдЦ ржЪрзНржпрж╛ржЯржмржЯ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржирж┐ржпрж╝ржорж╛ржмрж▓рзА:

тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ
тЭп рж╕рзЛрж░рзНрж╕ ржХрзЛржб: ЁЭР┤ЁЭСаЁЭСЦЁЭСУ ЁЭСАЁЭСОтДОЁЭСЪЁЭСвЁЭСС
тЭп ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржкрзНрж░рждрж┐ ржжрж┐ржирзЗ рзирзж ржмрж╛рж░ ржорзЗрж╕рзЗржЬ ржкрж╛ржарж╛рждрзЗ ржкрж╛рж░ржмрзЗржи
тЭп ржмржЯржХрзЗ ржЕрзНржпрж╛ржмрж┐ржЙржЬ ржХрж░ржмрзЗржи ржирж╛
тЭп ржЖржкржирж╛рж░ ржмржирзНржзрзБржжрзЗрж░ржУ ржмржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржжрж┐ржи
тЭп рж╕рзНржкрзНржпрж╛ржо ржХрж░рж╛ ржерзЗржХрзЗ ржмрж┐рж░ржд ржерж╛ржХрзБржи
тЭп рж╕ржмрж╛ржЗржХрзЗ рж╕ржорзНржорж╛ржи ржХрж░рзБржи
тЭп ржЕрж╢рзНрж▓рзАрж▓ ржХржирзНржЯрзЗржирзНржЯ ржирж┐рж╖рж┐ржжрзНржз
тЭп ржмржЯржХрзЗ ржмрзНржпржХрзНрждрж┐ржЧржд ржЖржХрзНрж░ржоржг ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи ржирж╛
тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ

ЁЯТЦ ЁЭСГЁЭСЬЁЭСдЁЭСТЁЭСЯЁЭСТЁЭСС ЁЭСПЁЭСж ЁЭР┤ЁЭСаЁЭСЦЁЭСУ ЁЭСАЁЭСОтДОЁЭСЪЁЭСвЁЭСС`;
            
            await message.reply(rulesMessage);
            console.log("тЬЕ ЁЭСЕЁЭСвЁЭСЩЁЭСТЁЭСа ЁЭСаЁЭСвЁЭСРЁЭСРЁЭСТЁЭСаЁЭСаЁЭСУЁЭСвЁЭСЩЁЭСЩЁЭСж ЁЭСаЁЭСТЁЭСЫЁЭСб");

        } catch (error) {
            console.error("тЭМ ЁЭСЕЁЭСвЁЭСЩЁЭСТЁЭР╡ЁЭСЬЁЭСб ЁЭСЬЁЭСЫЁЭСЖЁЭСбЁЭСОЁЭСЯЁЭСб ЁЭР╕ЁЭСЯЁЭСЯЁЭСЬЁЭСЯ:", error);
            
            // Try alternative response if first fails
            try {
                await message.reply("ЁЯУЭ ржмржЯ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржирж┐ржпрж╝ржо:\n\n1. ржжрж┐ржирзЗ рж╕рж░рзНржмрзЛржЪрзНржЪ рзирзж ржмрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи\n2. рж╕рзНржкрзНржпрж╛ржо ржХрж░ржмрзЗржи ржирж╛\n3. ржЕрзНржпрж╛ржмрж┐ржЙржЬ ржХрж░ржмрзЗржи ржирж╛\n4. рж╕ржмрж╛ржЗржХрзЗ рж╕ржорзНржорж╛ржи ржХрж░рзБржи\n\nЁЯТЦ ЁЭР┤ЁЭСаЁЭСЦЁЭСУ ЁЭСАЁЭСОтДОЁЭСЪЁЭСвЁЭСС");
            } catch (fallbackError) {
                console.error("тЭМ ЁЭР╣ЁЭСОЁЭСЩЁЭСЩЁЭСПЁЭСОЁЭСРЁЭСШ ЁЭСЯЁЭСТЁЭСаЁЭСЭЁЭСЬЁЭСЫЁЭСаЁЭСТ ЁЭСУЁЭСОЁЭСЦЁЭСЩЁЭСТЁЭСС:", fallbackError);
            }
        }
    },

    onChat: async function({ event, message }) {
        try {
            // Prevent multiple triggers in quick succession
            if (this.lastTriggerTime && Date.now() - this.lastTriggerTime < 5000) {
                return;
            }

            const triggers = [
                "rulebot", 
                "bot rules", 
                "rules", 
                "rule bot",
                "ржмржЯржирж┐ржпрж╝ржо",
                "ржирж┐ржпрж╝ржо",
                "rules bot",
                "bot rule",
                "ржмржЯ рж░рзБрж▓",
                "ржмржЯрзЗрж░ ржирж┐ржпрж╝ржо",
                "ржЪрзНржпрж╛ржЯржмржЯ ржирж┐ржпрж╝ржо",
                "ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржирж┐ржпрж╝ржо",
                "ржмржЯрж░рзБрж▓",
                "ржмржЯрзЗрж░ржирж┐ржпрж╝ржо",
                "ржирж┐ржпрж╝ржорж╛ржмрж▓рзА",
                "rules of bot",
                "bot policy",
                "ржмржЯ ржкрж▓рж┐рж╕рж┐",
                "ржЪрзНржпрж╛ржЯржмржЯ рж░рзБрж▓",
                "what are the rules",
                "how to use bot"
            ];
            
            const messageText = (event.body || "").toLowerCase().trim();
            
            if (!messageText) return;
            
            // Check if message contains any trigger words
            const hasTrigger = triggers.some(trigger => 
                messageText.includes(trigger.toLowerCase())
            );
            
            if (hasTrigger) {
                console.log(`ЁЯФФ ЁЭСЕЁЭСвЁЭСЩЁЭСТЁЭСПЁЭСЬЁЭСб ЁЭСбЁЭСЯЁЭСЦЁЭСФЁЭСФЁЭСТЁЭСЯЁЭСТЁЭСС ЁЭСПЁЭСж: ${event.senderID} - "${messageText}"`);
                
                // Update last trigger time
                this.lastTriggerTime = Date.now();
                
                const rulesMessage = `ЁЯдЦ ржЪрзНржпрж╛ржЯржмржЯ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржирж┐ржпрж╝ржорж╛ржмрж▓рзА:

тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ
тЭп рж╕рзЛрж░рзНрж╕ ржХрзЛржб: ЁЭР┤ЁЭСаЁЭСЦЁЭСУ ЁЭСАЁЭСОтДОЁЭСЪЁЭСвЁЭСС
тЭп ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржкрзНрж░рждрж┐ ржжрж┐ржирзЗ рзирзж ржмрж╛рж░ ржорзЗрж╕рзЗржЬ ржкрж╛ржарж╛рждрзЗ ржкрж╛рж░ржмрзЗржи
тЭп ржмржЯржХрзЗ ржЕрзНржпрж╛ржмрж┐ржЙржЬ ржХрж░ржмрзЗржи ржирж╛
тЭп ржЖржкржирж╛рж░ ржмржирзНржзрзБржжрзЗрж░ржУ ржмржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржжрж┐ржи
тЭп рж╕рзНржкрзНржпрж╛ржо ржХрж░рж╛ ржерзЗржХрзЗ ржмрж┐рж░ржд ржерж╛ржХрзБржи
тЭп рж╕ржмрж╛ржЗржХрзЗ рж╕ржорзНржорж╛ржи ржХрж░рзБржи
тЭп ржЕрж╢рзНрж▓рзАрж▓ ржХржирзНржЯрзЗржирзНржЯ ржирж┐рж╖рж┐ржжрзНржз
тЭп ржмржЯржХрзЗ ржмрзНржпржХрзНрждрж┐ржЧржд ржЖржХрзНрж░ржоржг ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи ржирж╛
тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ тЦВ

ЁЯТЦ ЁЭСГЁЭСЬЁЭСдЁЭСТЁЭСЯЁЭСТЁЭСС ЁЭСПЁЭСж ЁЭР┤ЁЭСаЁЭСЦЁЭСУ ЁЭСАЁЭСОтДОЁЭСЪЁЭСвЁЭСС`;
                
                await message.reply(rulesMessage);
                console.log("тЬЕ ЁЭР┤ЁЭСвЁЭСбЁЭСЬ-ЁЭСЯЁЭСТЁЭСаЁЭСЭЁЭСЬЁЭСЫЁЭСаЁЭСТ ЁЭСЯЁЭСвЁЭСЩЁЭСТЁЭСа ЁЭСаЁЭСТЁЭСЫЁЭСб");
            }
        } catch (error) {
            console.error("тЭМ ЁЭСЕЁЭСвЁЭСЩЁЭСТЁЭР╡ЁЭСЬЁЭСб ЁЭСЬЁЭСЫЁЭР╢тДОЁЭСОЁЭСб ЁЭР╕ЁЭСЯЁЭСЯЁЭСЬЁЭСЯ:", error);
            // Silent fail for onChat to avoid spam
        }
    },

    // Initialize lastTriggerTime
    lastTriggerTime: null
};
