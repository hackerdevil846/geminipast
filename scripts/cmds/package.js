const axios = require("axios");
const request = require("request");
const fs = require("fs-extra");

module.exports = {
  config: {
    name: "package",
    aliases: ["pkg", "projectinfo"],
    version: "1.0.2",
    author: "ğ‘¨ğ’”ğ’Šğ’‡ ğ‘´ğ’‚ğ’‰ğ’ğ’–ğ’…",
    countDown: 1,
    role: 0,
    category: "ğŸ›¡ï¸ ğ‘ºğ’šğ’”ğ’•ğ’†ğ’",
    shortDescription: {
      en: "ğŸ“¦ ğ‘·ğ’“ğ’ğ’‹ğ’†ğ’„ğ’• ğ’‘ğ’‚ğ’„ğ’Œğ’‚ğ’ˆğ’† ğ’Šğ’ğ’‡ğ’ğ’“ğ’ğ’‚ğ’•ğ’Šğ’ğ’"
    },
    longDescription: {
      en: "ğŸ“¦ ğ‘ºğ’‰ğ’ğ’˜ğ’” ğ’•ğ’‰ğ’† ğ’‘ğ’“ğ’ğ’‹ğ’†ğ’„ğ’• ğ’‘ğ’‚ğ’„ğ’Œğ’‚ğ’ˆğ’† ğ’Šğ’ğ’‡ğ’ğ’“ğ’ğ’‚ğ’•ğ’Šğ’ğ’ ğ’‚ğ’ğ’… ğ’…ğ’†ğ’‘ğ’†ğ’ğ’…ğ’†ğ’ğ’„ğ’Šğ’†ğ’”"
    },
    guide: {
      en: "{ğ‘}package"
    },
    dependencies: {
      "axios": "",
      "request": "",
      "fs-extra": ""
    }
  },

  onStart: async function({ api, event }) {
    try {
      // Dependency check
      if (!axios) throw new Error("ğ‘€ğ‘–ğ‘ ğ‘ ğ‘–ğ‘›ğ‘” ğ‘‘ğ‘’ğ‘ğ‘’ğ‘›ğ‘‘ğ‘’ğ‘›ğ‘ğ‘¦: ğ‘ğ‘¥ğ‘–ğ‘œğ‘ ");
      if (!request) throw new Error("ğ‘€ğ‘–ğ‘ ğ‘ ğ‘–ğ‘›ğ‘” ğ‘‘ğ‘’ğ‘ğ‘’ğ‘›ğ‘‘ğ‘’ğ‘›ğ‘ğ‘¦: ğ‘Ÿğ‘’ğ‘ğ‘¢ğ‘’ğ‘ ğ‘¡");
      if (!fs) throw new Error("ğ‘€ğ‘–ğ‘ ğ‘ ğ‘–ğ‘›ğ‘” ğ‘‘ğ‘’ğ‘ğ‘’ğ‘›ğ‘‘ğ‘’ğ‘›ğ‘ğ‘¦: ğ‘“ğ‘ -ğ‘’ğ‘¥ğ‘¡ğ‘Ÿğ‘");

      const link = ["https://i.imgur.com/6UxTLqh.png"];
      
      const callback = () => {
        api.sendMessage({
          body: `{
  "ğ’ğ’‚ğ’ğ’†": "ğ‘¨ğ’”ğ’Šğ’‡ğ‘©ğ’ğ’•",
  "ğ’—ğ’†ğ’“ğ’”ğ’Šğ’ğ’": "30.0.0",
  "ğ’…ğ’†ğ’”ğ’„ğ’“ğ’Šğ’‘ğ’•ğ’Šğ’ğ’": "ğ‘­ğ’‚ğ’„ğ’†ğ’ƒğ’ğ’ğ’Œ ğ‘´ğ’†ğ’”ğ’”ğ’†ğ’ğ’ˆğ’†ğ’“ ğ‘©ğ’ğ’• ğ’ƒğ’š ğ‘¨ğ’”ğ’Šğ’‡ ğ‘´ğ’‚ğ’‰ğ’ğ’–ğ’…",
  "ğ’ğ’‚ğ’Šğ’": "ğ‘¨ğ’”ğ’Šğ’‡ğ‘©ğ’ğ’•.ğ’‹ğ’”",
  "ğ’”ğ’„ğ’“ğ’Šğ’‘ğ’•ğ’”": {
    "ğ’”ğ’•ğ’‚ğ’“ğ’•": "ğ’ğ’ğ’…ğ’† ğ’Šğ’ğ’…ğ’†ğ’™.ğ’‹ğ’”",
    "ğ’ğ’ğ’ˆğ’Šğ’": "ğ’ğ’ğ’…ğ’† ğ’ğ’ğ’ˆğ’Šğ’",
    "ğ’•ğ’†ğ’”ğ’•": "ğ’ğ’ğ’…ğ’† --ğ’•ğ’“ğ’‚ğ’„ğ’†-ğ’˜ğ’‚ğ’“ğ’ğ’Šğ’ğ’ˆğ’” --ğ’–ğ’”ğ’†_ğ’”ğ’•ğ’“ğ’Šğ’„ğ’• --ğ’‚ğ’”ğ’šğ’ğ’„-ğ’”ğ’•ğ’‚ğ’„ğ’Œ-ğ’•ğ’“ğ’‚ğ’„ğ’†ğ’” ğ’ğ’Šğ’“ğ’‚ğ’Š"
  },
  "ğ’“ğ’†ğ’‘ğ’ğ’”ğ’Šğ’•ğ’ğ’“ğ’š": {
    "ğ’•ğ’šğ’‘ğ’†": "ğ’ˆğ’Šğ’•",
    "ğ’–ğ’“ğ’": "ğ’‰ğ’•ğ’•ğ’‘ğ’”://ğ’ˆğ’Šğ’•ğ’‰ğ’–ğ’ƒ.ğ’„ğ’ğ’/ğ‘¨ğ’”ğ’Šğ’‡-ğ‘´ğ’‚ğ’‰ğ’ğ’–ğ’…/ğ’‡ğ’ƒ-ğ’ƒğ’ğ’•"
  },
  "ğ’Œğ’†ğ’šğ’˜ğ’ğ’“ğ’…ğ’”": [
    "ğ’ƒğ’ğ’•",
    "ğ’‡ğ’‚ğ’„ğ’†ğ’ƒğ’ğ’ğ’Œ",
    "ğ’‚ğ’”ğ’Šğ’‡ğ’ğ’‚ğ’‰ğ’ğ’–ğ’…",
    "ğ’ğ’†ğ’”ğ’”ğ’†ğ’ğ’ˆğ’†ğ’“",
    "ğ’‹ğ’‚ğ’—ğ’‚ğ’”ğ’„ğ’“ğ’Šğ’‘ğ’•",
    "ğ’‚ğ’”ğ’Šğ’‡",
    "ğ’ğ’‚ğ’‰ğ’ğ’–ğ’…",
    "ğ’‚ğ’Š"
  ],
  "ğ’‚ğ’–ğ’•ğ’‰ğ’ğ’“": "ğ‘¨ğ’”ğ’Šğ’‡ ğ‘´ğ’‚ğ’‰ğ’ğ’–ğ’…",
  "ğ’ğ’Šğ’„ğ’†ğ’ğ’”ğ’†": "ğ‘®ğ‘·ğ‘³-3.0",
  "ğ’ƒğ’–ğ’ˆğ’”": {
    "ğ’–ğ’“ğ’": "ğ’‰ğ’•ğ’•ğ’‘ğ’”://ğ’ˆğ’Šğ’•ğ’‰ğ’–ğ’ƒ.ğ’„ğ’ğ’/ğ‘¨ğ’”ğ’Šğ’‡-ğ‘´ğ’‚ğ’‰ğ’ğ’–ğ’…/ğ’‡ğ’ƒ-ğ’ƒğ’ğ’•/ğ’Šğ’”ğ’”ğ’–ğ’†ğ’”"
  },
  "ğ’‰ğ’ğ’ğ’†ğ’‘ğ’‚ğ’ˆğ’†": "ğ’‰ğ’•ğ’•ğ’‘ğ’”://ğ’ˆğ’Šğ’•ğ’‰ğ’–ğ’ƒ.ğ’„ğ’ğ’/ğ‘¨ğ’”ğ’Šğ’‡-ğ‘´ğ’‚ğ’‰ğ’ğ’–ğ’…/ğ’‡ğ’ƒ-ğ’ƒğ’ğ’•#ğ’“ğ’†ğ’‚ğ’…ğ’ğ’†",
  "ğ’…ğ’†ğ’‘ğ’†ğ’ğ’…ğ’†ğ’ğ’„ğ’Šğ’†ğ’”": {
    "@ğ’‚ğ’”ğ’Šğ’‡ğ’ğ’‚ğ’‰ğ’ğ’–ğ’…/ğ’‚ğ’”ğ’”ğ’†ğ’•ğ’”": "",
    "@ğ’“ğ’†ğ’‘ğ’ğ’Šğ’•/ğ’…ğ’‚ğ’•ğ’‚ğ’ƒğ’‚ğ’”ğ’†": "^2.0.1",
    "ğ’‚ğ’™ğ’Šğ’ğ’”": "^0.26.1",
    "ğ’„ğ’‚ğ’ğ’—ğ’‚ğ’”": "^2.7.0",
    "ğ’„ğ’‰ğ’‚ğ’ğ’Œ": "^4.1.2",
    "ğ’‡ğ’„ğ’‚-ğ’–ğ’ğ’ğ’‡ğ’‡ğ’Šğ’„ğ’Šğ’‚ğ’": "^1.3.13-2",
    "ğ’‡ğ’”-ğ’†ğ’™ğ’•ğ’“ğ’‚": "^10.0.1",
    "ğ’‹ğ’Šğ’ğ’‘": "",
    "ğ’ğ’ğ’ğ’†ğ’ğ’•-ğ’•ğ’Šğ’ğ’†ğ’›ğ’ğ’ğ’†": "^0.5.34",
    "ğ’“ğ’†ğ’’ğ’–ğ’†ğ’”ğ’•": "^2.88.2",
    "ğ’šğ’•ğ’…ğ’-ğ’„ğ’ğ’“ğ’†": "^4.11.0"
  }
}`,
          attachment: fs.createReadStream(__dirname + "/cache/package.png")
        }, event.threadID, () => {
          try {
            fs.unlinkSync(__dirname + "/cache/package.png");
          } catch (e) {}
        });
      };
      
      // Create cache directory if it doesn't exist
      const cacheDir = __dirname + "/cache";
      if (!fs.existsSync(cacheDir)) {
        fs.mkdirSync(cacheDir, { recursive: true });
      }

      const imageUrl = link[Math.floor(Math.random() * link.length)];
      
      // Download image
      const response = await axios({
        method: 'GET',
        url: imageUrl,
        responseType: 'stream'
      });

      const writer = fs.createWriteStream(__dirname + "/cache/package.png");
      response.data.pipe(writer);
      
      writer.on('finish', callback);
      writer.on('error', (error) => {
        console.error("ğ‘°ğ’ğ’‚ğ’ˆğ’† ğ’…ğ’ğ’˜ğ’ğ’ğ’ğ’‚ğ’… ğ’†ğ’“ğ’“ğ’ğ’“:", error);
        api.sendMessage("âŒ ğ‘°ğ’ğ’‚ğ’ˆğ’† ğ’…ğ’ğ’˜ğ’ğ’ğ’ğ’‚ğ’… ğ’‡ğ’‚ğ’Šğ’ğ’†ğ’…. ğ‘·ğ’ğ’†ğ’‚ğ’”ğ’† ğ’•ğ’“ğ’š ğ’‚ğ’ˆğ’‚ğ’Šğ’ ğ’ğ’‚ğ’•ğ’†ğ’“.", event.threadID, event.messageID);
      });

    } catch (error) {
      console.error("ğ‘·ğ’‚ğ’„ğ’Œğ’‚ğ’ˆğ’† ğ‘ªğ’ğ’ğ’ğ’‚ğ’ğ’… ğ‘¬ğ’“ğ’“ğ’ğ’“:", error);
      api.sendMessage(`âŒ ğ‘¬ğ’“ğ’“ğ’ğ’“: ${error.message}`, event.threadID, event.messageID);
    }
  }
};
