module.exports = {
	config: {
		name: "setalias",
		version: "1.8",
		author: "NTKhang & ğ´ğ‘ ğ‘–ğ‘“ ğ‘€ğ‘â„ğ‘šğ‘¢ğ‘‘",
		countDown: 5,
		role: 0,
		description: {
			en: "ğ´ğ‘‘ğ‘‘ ğ‘ğ‘› ğ‘ğ‘™ğ‘–ğ‘ğ‘  ğ‘“ğ‘œğ‘Ÿ ğ‘ğ‘›ğ‘¦ ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ ğ‘–ğ‘› ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘"
		},
		category: "config",
		guide: {
			en: "â•­â”€â”â”â”â”â”â”â”â”â”â”â”â”â”€â•®\n" +
				"â”‚    ğ€ğ‹ğˆğ€ğ’ ğ†ğ”ğˆğƒğ„    â”‚\n" +
				"â•°â”€â”â”â”â”â”â”â”â”â”â”â”â”â”€â•¯\n" +
				"ğŸ”¹ {pn} ğ‘ğ‘‘ğ‘‘ <ğ‘ğ‘™ğ‘–ğ‘ğ‘ > <ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘>\n" +
				"   â†³ ğ´ğ‘‘ğ‘‘ ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘ ğ‘ğ‘™ğ‘–ğ‘ğ‘ \n\n" +
				"ğŸ”¹ {pn} ğ‘ğ‘‘ğ‘‘ <ğ‘ğ‘™ğ‘–ğ‘ğ‘ > <ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘> -ğ‘”\n" +
				"   â†³ ğ´ğ‘‘ğ‘‘ ğ‘”ğ‘™ğ‘œğ‘ğ‘ğ‘™ ğ‘ğ‘™ğ‘–ğ‘ğ‘  (ğ‘ğ‘‘ğ‘šğ‘–ğ‘› ğ‘œğ‘›ğ‘™ğ‘¦)\n\n" +
				"ğŸ”¹ {pn} [ğ‘Ÿğ‘’ğ‘šğ‘œğ‘£ğ‘’ | ğ‘Ÿğ‘š] <ğ‘ğ‘™ğ‘–ğ‘ğ‘ > <ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘>\n" +
				"   â†³ ğ‘…ğ‘’ğ‘šğ‘œğ‘£ğ‘’ ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘ ğ‘ğ‘™ğ‘–ğ‘ğ‘ \n\n" +
				"ğŸ”¹ {pn} [ğ‘Ÿğ‘’ğ‘šğ‘œğ‘£ğ‘’ | ğ‘Ÿğ‘š] <ğ‘ğ‘™ğ‘–ğ‘ğ‘ > <ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘> -ğ‘”\n" +
				"   â†³ ğ‘…ğ‘’ğ‘šğ‘œğ‘£ğ‘’ ğ‘”ğ‘™ğ‘œğ‘ğ‘ğ‘™ ğ‘ğ‘™ğ‘–ğ‘ğ‘  (ğ‘ğ‘‘ğ‘šğ‘–ğ‘› ğ‘œğ‘›ğ‘™ğ‘¦)\n\n" +
				"ğŸ”¹ {pn} ğ‘™ğ‘–ğ‘ ğ‘¡\n" +
				"   â†³ ğ¿ğ‘–ğ‘ ğ‘¡ ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘ ğ‘ğ‘™ğ‘–ğ‘ğ‘ ğ‘’ğ‘ \n\n" +
				"ğŸ”¹ {pn} ğ‘™ğ‘–ğ‘ ğ‘¡ -ğ‘”\n" +
				"   â†³ ğ¿ğ‘–ğ‘ ğ‘¡ ğ‘”ğ‘™ğ‘œğ‘ğ‘ğ‘™ ğ‘ğ‘™ğ‘–ğ‘ğ‘ ğ‘’ğ‘ \n\n" +
				"â•­â”€â”â”â”â”â”â”â”â”â”â”â”€â•®\n" +
				"â”‚   ğ„ğ—ğ€ğŒğğ‹ğ„ğ’   â”‚\n" +
				"â•°â”€â”â”â”â”â”â”â”â”â”â”â”€â•¯\n" +
				"âœ¨ {pn} ğ‘ğ‘‘ğ‘‘ ğ‘ğ‘¡ğ‘Ÿğ‘˜ ğ‘ğ‘¢ğ‘ ğ‘¡ğ‘œğ‘šğ‘Ÿğ‘ğ‘›ğ‘˜ğ‘ğ‘ğ‘Ÿğ‘‘\n" +
				"âœ¨ {pn} ğ‘Ÿğ‘š ğ‘ğ‘¡ğ‘Ÿğ‘˜ ğ‘ğ‘¢ğ‘ ğ‘¡ğ‘œğ‘šğ‘Ÿğ‘ğ‘›ğ‘˜ğ‘ğ‘ğ‘Ÿğ‘‘\n" +
				"âœ¨ {pn} ğ‘™ğ‘–ğ‘ ğ‘¡"
		}
	},

	langs: {
		en: {
			commandNotExist: "âŒ ğ¶ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%1\" ğ‘‘ğ‘œğ‘’ğ‘  ğ‘›ğ‘œğ‘¡ ğ‘’ğ‘¥ğ‘–ğ‘ ğ‘¡",
			aliasExist: "âŒ ğ´ğ‘™ğ‘–ğ‘ğ‘  \"%1\" ğ‘ğ‘™ğ‘Ÿğ‘’ğ‘ğ‘‘ğ‘¦ ğ‘’ğ‘¥ğ‘–ğ‘ ğ‘¡ğ‘  ğ‘“ğ‘œğ‘Ÿ ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%2\" ğ‘–ğ‘› ğ‘¡â„ğ‘’ ğ‘ ğ‘¦ğ‘ ğ‘¡ğ‘’ğ‘š",
			addAliasSuccess: "âœ… ğ´ğ‘‘ğ‘‘ğ‘’ğ‘‘ ğ‘ğ‘™ğ‘–ğ‘ğ‘  \"%1\" ğ‘“ğ‘œğ‘Ÿ ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%2\" ğ‘–ğ‘› ğ‘¡â„ğ‘’ ğ‘ ğ‘¦ğ‘ ğ‘¡ğ‘’ğ‘š",
			noPermissionAdd: "âŒ ğ‘Œğ‘œğ‘¢ ğ‘‘ğ‘œğ‘›'ğ‘¡ â„ğ‘ğ‘£ğ‘’ ğ‘ğ‘’ğ‘Ÿğ‘šğ‘–ğ‘ ğ‘ ğ‘–ğ‘œğ‘› ğ‘¡ğ‘œ ğ‘ğ‘‘ğ‘‘ ğ‘”ğ‘™ğ‘œğ‘ğ‘ğ‘™ ğ‘ğ‘™ğ‘–ğ‘ğ‘ ğ‘’ğ‘ ",
			aliasIsCommand: "âŒ ğ´ğ‘™ğ‘–ğ‘ğ‘  \"%1\" ğ‘ğ‘œğ‘›ğ‘“ğ‘™ğ‘–ğ‘ğ‘¡ğ‘  ğ‘¤ğ‘–ğ‘¡â„ ğ‘’ğ‘¥ğ‘–ğ‘ ğ‘¡ğ‘–ğ‘›ğ‘” ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘",
			aliasExistInGroup: "âŒ ğ´ğ‘™ğ‘–ğ‘ğ‘  \"%1\" ğ‘ğ‘™ğ‘Ÿğ‘’ğ‘ğ‘‘ğ‘¦ ğ‘’ğ‘¥ğ‘–ğ‘ ğ‘¡ğ‘  ğ‘“ğ‘œğ‘Ÿ ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%2\" ğ‘–ğ‘› ğ‘¡â„ğ‘–ğ‘  ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘",
			addAliasToGroupSuccess: "âœ¨ ğ´ğ‘™ğ‘–ğ‘ğ‘  \"%1\" ğ‘ğ‘‘ğ‘‘ğ‘’ğ‘‘ ğ‘“ğ‘œğ‘Ÿ ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%2\" ğ‘–ğ‘› ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘",
			aliasNotExist: "âŒ ğ´ğ‘™ğ‘–ğ‘ğ‘  \"%1\" ğ‘‘ğ‘œğ‘’ğ‘  ğ‘›ğ‘œğ‘¡ ğ‘’ğ‘¥ğ‘–ğ‘ ğ‘¡ ğ‘“ğ‘œğ‘Ÿ ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%2\"",
			removeAliasSuccess: "ğŸ—‘ï¸ ğ´ğ‘™ğ‘–ğ‘ğ‘  \"%1\" ğ‘Ÿğ‘’ğ‘šğ‘œğ‘£ğ‘’ğ‘‘ ğ‘“ğ‘Ÿğ‘œğ‘š ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%2\" ğ‘–ğ‘› ğ‘¡â„ğ‘’ ğ‘ ğ‘¦ğ‘ ğ‘¡ğ‘’ğ‘š",
			noPermissionDelete: "âŒ ğ‘Œğ‘œğ‘¢ ğ‘‘ğ‘œğ‘›'ğ‘¡ â„ğ‘ğ‘£ğ‘’ ğ‘ğ‘’ğ‘Ÿğ‘šğ‘–ğ‘ ğ‘ ğ‘–ğ‘œğ‘› ğ‘¡ğ‘œ ğ‘Ÿğ‘’ğ‘šğ‘œğ‘£ğ‘’ ğ‘”ğ‘™ğ‘œğ‘ğ‘ğ‘™ ğ‘ğ‘™ğ‘–ğ‘ğ‘ ğ‘’ğ‘ ",
			noAliasInGroup: "âŒ ğ¶ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%1\" â„ğ‘ğ‘  ğ‘›ğ‘œ ğ‘ğ‘™ğ‘–ğ‘ğ‘ ğ‘’ğ‘  ğ‘–ğ‘› ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘",
			removeAliasInGroupSuccess: "ğŸ—‘ï¸ ğ´ğ‘™ğ‘–ğ‘ğ‘  \"%1\" ğ‘Ÿğ‘’ğ‘šğ‘œğ‘£ğ‘’ğ‘‘ ğ‘“ğ‘Ÿğ‘œğ‘š ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ \"%2\" ğ‘–ğ‘› ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘",
			aliasList: "â•­â”€â”â”â”â”â”â”â”â”â”â”â”â”â”â”€â•®\n" +
					   "â”‚  ğ†ğ‹ğğğ€ğ‹ ğ€ğ‹ğˆğ€ğ’ğ„ğ’  â”‚\n" +
					   "â•°â”€â”â”â”â”â”â”â”â”â”â”â”â”â”â”€â•¯\n%1",
			noAliasInSystem: "â„¹ï¸ ğ‘ğ‘œ ğ‘”ğ‘™ğ‘œğ‘ğ‘ğ‘™ ğ‘ğ‘™ğ‘–ğ‘ğ‘ ğ‘’ğ‘  ğ‘’ğ‘¥ğ‘–ğ‘ ğ‘¡",
			notExistAliasInGroup: "â„¹ï¸ ğ‘Œğ‘œğ‘¢ğ‘Ÿ ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘ â„ğ‘ğ‘  ğ‘›ğ‘œ ğ‘ğ‘™ğ‘–ğ‘ğ‘ ğ‘’ğ‘ ",
			aliasListInGroup: "â•­â”€â”â”â”â”â”â”â”â”â”â”â”â”â”â”€â•®\n" +
							  "â”‚  ğ†ğ‘ğğ”ğ ğ€ğ‹ğˆğ€ğ’ğ„ğ’  â”‚\n" +
							  "â•°â”€â”â”â”â”â”â”â”â”â”â”â”â”â”â”€â•¯\n%1"
		}
	},

	onStart: async function ({ message, event, args, threadsData, globalData, role, getLang }) {
		const aliasesData = await threadsData.get(event.threadID, "data.aliases", {});

		switch (args[0]) {
			case "add": {
				if (!args[2])
					return message.SyntaxError();
				const commandName = args[2].toLowerCase();
				if (!global.GoatBot.commands.has(commandName))
					return message.reply(getLang("commandNotExist", commandName));
				const alias = args[1].toLowerCase();

				if (args[3] == '-g') {
					if (role < 2) {
						return message.reply(getLang("noPermissionAdd", alias, commandName));
					}
					
					const globalAliasesData = await globalData.get('setalias', 'data', []);
					const globalAliasesExist = globalAliasesData.find(item => item.aliases.includes(alias));
					if (globalAliasesExist)
						return message.reply(getLang("aliasExist", alias, globalAliasesExist.commandName));
					if (global.GoatBot.aliases.has(alias))
						return message.reply(getLang("aliasExist", alias, global.GoatBot.aliases.get(alias)));
					
					const globalAliasesThisCommand = globalAliasesData.find(aliasData => aliasData.commandName == commandName);
					if (globalAliasesThisCommand)
						globalAliasesThisCommand.aliases.push(alias);
					else
						globalAliasesData.push({
							commandName,
							aliases: [alias]
						});
					
					await globalData.set('setalias', globalAliasesData, 'data');
					global.GoatBot.aliases.set(alias, commandName);
					return message.reply(getLang("addAliasSuccess", alias, commandName));
				}

				if (global.GoatBot.commands.get(alias))
					return message.reply(getLang("aliasIsCommand", alias));
				if (global.GoatBot.aliases.has(alias))
					return message.reply(getLang("aliasExist", alias, global.GoatBot.aliases.get(alias)));
				
				for (const cmdName in aliasesData)
					if (aliasesData[cmdName].includes(alias))
						return message.reply(getLang("aliasExistInGroup", alias, cmdName));

				const oldAlias = aliasesData[commandName] || [];
				oldAlias.push(alias);
				aliasesData[commandName] = oldAlias;
				await threadsData.set(event.threadID, aliasesData, "data.aliases");
				return message.reply(getLang("addAliasToGroupSuccess", alias, commandName));
			}
			
			case "remove":
			case "rm": {
				if (!args[2])
					return message.SyntaxError();
				const commandName = args[2].toLowerCase();
				const alias = args[1].toLowerCase();

				if (!global.GoatBot.commands.has(commandName))
					return message.reply(getLang("commandNotExist", commandName));

				if (args[3] == '-g') {
					if (role < 2) {
						return message.reply(getLang("noPermissionDelete", alias, commandName));
					}
					
					const globalAliasesData = await globalData.get('setalias', 'data', []);
					const globalAliasesThisCommand = globalAliasesData.find(aliasData => aliasData.commandName == commandName);
					if (!globalAliasesThisCommand || !globalAliasesThisCommand.aliases.includes(alias))
						return message.reply(getLang("aliasNotExist", alias, commandName));
					
					globalAliasesThisCommand.aliases.splice(globalAliasesThisCommand.aliases.indexOf(alias), 1);
					await globalData.set('setalias', globalAliasesData, 'data');
					global.GoatBot.aliases.delete(alias);
					return message.reply(getLang("removeAliasSuccess", alias, commandName));
				}

				const oldAlias = aliasesData[commandName];
				if (!oldAlias)
					return message.reply(getLang("noAliasInGroup", commandName));
				
				const index = oldAlias.indexOf(alias);
				if (index === -1)
					return message.reply(getLang("aliasNotExist", alias, commandName));
				
				oldAlias.splice(index, 1);
				await threadsData.set(event.threadID, aliasesData, "data.aliases");
				return message.reply(getLang("removeAliasInGroupSuccess", alias, commandName));
			}
			
			case "list": {
				if (args[1] == '-g') {
					const globalAliasesData = await globalData.get('setalias', 'data', []);
					const globalAliases = globalAliasesData.map(aliasData => ({
						commandName: aliasData.commandName,
						aliases: aliasData.aliases.join(', ')
					}));
					
					return message.reply(
						globalAliases.length ?
							getLang("aliasList", globalAliases.map(alias => `ğŸ”¹ ${alias.commandName}: ${alias.aliases}`).join('\n')) :
							getLang("noAliasInSystem")
					);
				}

				if (!Object.keys(aliasesData).length)
					return message.reply(getLang("notExistAliasInGroup"));
				
				const list = Object.keys(aliasesData).map(commandName => `ğŸ”¹ ${commandName}: ${aliasesData[commandName].join(", ")}`);
				return message.reply(getLang("aliasListInGroup", list.join("\n")));
			}
			
			default: {
				return message.SyntaxError();
			}
		}
	}
};
