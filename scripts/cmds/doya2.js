const fs = require("fs-extra");
const axios = require("axios");
const path = require("path");

module.exports = {
    config: {
        name: "doya2",
        aliases: [],
        version: "1.3.0",
        author: "Asif Mahmud",
        countDown: 5,
        role: 0,
        category: "islamic",
        shortDescription: {
            en: "Islamic prayers and duas with images"
        },
        longDescription: {
            en: "Provides Islamic prayers and duas with beautiful images"
        },
        guide: {
            en: "{p}doya2\n{p}doya2 [number]"
        },
        dependencies: {
            "fs-extra": "",
            "axios": "",
            "path": ""
        }
    },

    onLoad: async function() {
        try {
            const cacheDir = path.join(__dirname, 'cache', 'doya_images');
            if (!fs.existsSync(cacheDir)) {
                fs.mkdirSync(cacheDir, { recursive: true });
                console.log("тЬЕ Doya images cache directory created");
            }
        } catch (error) {
            console.error("тЭМ Cache directory creation error:", error);
        }
    },

    onStart: async function({ message, args }) {
        try {
            // Dependency check
            try {
                require("fs-extra");
                require("axios");
                require("path");
            } catch (e) {
                return message.reply("тЭМ Missing dependencies: fs-extra, axios, path");
            }

            const doyaContent = [
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзз:\n\nрж╣рзЗ ржЖржорж╛ржжрзЗрж░ ржкрж╛рж▓ржиржХрж░рзНрждрж╛, ржЖржорж╛ржжрзЗрж░ ржЧрзБржирж╛рж╣рж╕ржорзВрж╣ ржорж╛ржл ржХрж░рзЗ ржжрж╛ржУ, ржЖржорж╛ржжрзЗрж░ ржерзЗржХрзЗ рж╕ржХрж▓ ржоржирзНржж ржжрзВрж░рзЗ рж░рж╛ржЦрзЛ ржПржмржВ ржЖржорж╛ржжрзЗрж░ ржирзЗржХ рж▓рзЛржХржжрзЗрж░ рж╕рж╛рж╣ржЪрж╛рж░рзНржп ржжрж╛ржи ржХрж░рзЛред ЁЯМ┐",
                    image: "https://i.imgur.com/aESlOKd.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзи:\n\n╪▒┘О╪и┘О┘С┘Ж┘О╪з ┘З┘О╪и┘Т ┘Д┘О┘Ж┘О╪з ┘Е┘Р┘Ж┘Т ╪г┘О╪▓┘Т┘И┘О╪з╪м┘Р┘Ж┘О╪з ┘И┘О╪░┘П╪▒┘Р┘С┘К┘О┘С╪з╪к┘Р┘Ж┘О╪з ┘В┘П╪▒┘О┘С╪й┘О ╪г┘О╪╣┘Т┘К┘П┘Ж┘Н ┘И┘О╪з╪м┘Т╪╣┘О┘Д┘Т┘Ж┘О╪з ┘Д┘Р┘Д┘Т┘Е┘П╪к┘О┘С┘В┘Р┘К┘Ж┘О ╪е┘Р┘Е┘О╪з┘Е┘Л╪з\n\nржЙржЪрзНржЪрж╛рж░ржг: 'рж░рж╛ржмрзНржмрж╛ржирж╛ рж╣рж╛ржмрзНрж▓рж╛ржирж╛ ржорж┐ржи ржЖржпржУрзЯрж╛ржЭрж┐ржирж╛ ржУрзЯрж╛ ржЬрзБрж░рзНрж░рж┐рзЯрж╛рждрж┐ржирж╛ ржХрзБрж░рзНрж░рж╛рждрж╛ ржЖржЗрзЯрзБржирж┐ржУ ржУрзЯрж╛ржЭржЖрж▓ржирж╛ рж▓рж┐рж▓ржорзБрждрзНрждрж╛ржХрзНржмрж┐ржирж╛ ржЗржорж╛ржорж╛ред'\n\nржЕрж░рзНрже: 'рж╣рзЗ ржЖржорж╛ржжрзЗрж░ ржкрзНрж░рждрж┐ржкрж╛рж▓ржХ! ржЖржорж╛ржжрзЗрж░ржХрзЗ ржЖржорж╛ржжрзЗрж░ рж╕рзНрждрзНрж░рзАржЧржг ржУ рж╕ржирзНрждрж╛ржи-рж╕ржирзНрждрзБрждрж┐рж░ ржоржзрзНржпрзЗ ржЪрзЛржЦрзЗрж░ рж╢рзАрждрж▓рждрж╛ ржжрж╛ржи ржХрж░рзБржи ржПржмржВ ржЖржорж╛ржжрзЗрж░ржХрзЗ ржорзБрждрзНрждрж╛ржХрзАржжрзЗрж░ ржирзЗрждрж╛ ржмрж╛ржирж┐ржпрж╝рзЗ ржжрж┐ржиред' тЬи",
                    image: "https://i.imgur.com/aESlOKd.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзй:\n\n╪и┘Р╪│┘Т┘Е┘Р ╪з┘Д┘Д┘С┘З┘Р ╪з┘Д┘Д┘С┘З┘П┘Е┘О┘С ╪м┘О┘Ж┘Р┘С╪и┘Т┘Ж┘О╪з ╪з┘Д╪┤┘О┘С┘К┘Т╪╖┘О╪з┘Ж┘О ┘И┘О ╪м┘О┘Ж┘Р┘С╪и┘Р ╪з┘Д╪┤┘О┘С┘К┘Т╪╖┘О╪з┘Ж┘О ┘Е┘О╪з ╪▒┘О╪▓┘О┘В┘Т╪к┘О┘Ж┘О╪з\n\nржЙржЪрзНржЪрж╛рж░ржг: 'ржмрж┐рж╕ржорж┐рж▓рзНрж▓рж╛рж╣рж┐ ржЖрж▓рзНрж▓рж╛рж╣рзБржорзНржорж╛ ржЬрж╛ржирзНржирж┐ржмржирж╛рж╢ рж╢рж╛ржпрж╝рждрзНржмрж╛ржирж╛ ржУржпрж╝рж╛ ржЬрж╛ржирзНржирж┐ржмрж┐рж╢ рж╢рж╛ржпрж╝рждрзНржмрж╛ржирж╛ ржорж╛ рж░рж╛ржпрж╛ржХрзНржмрждрж╛ржирж╛ред'\n\nржЕрж░рзНрже: 'ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж╛ржорзЗ рж╢рзБрж░рзБ ржХрж░ржЫрж┐, рж╣рзЗ ржЖрж▓рзНрж▓рж╛рж╣! ржЖржорж╛ржжрзЗрж░ржХрзЗ рждрзБржорж┐ рж╢ржпрж╝рждрж╛ржи ржерзЗржХрзЗ ржжрзВрж░рзЗ рж░рж╛ржЦ ржПржмржВ рж╢ржпрж╝рждрж╛ржиржХрзЗ ржжрзВрж░рзЗ рж░рж╛ржЦ рж╕рзЗ ржмрж╕рзНрждрзБ ржерзЗржХрзЗ ржпрж╛ рждрзБржорж┐ ржЖржорж╛ржжрзЗрж░ржХрзЗ ржжрж╛ржи ржХрж░рзЗржЫред' ЁЯЫбя╕П",
                    image: "https://i.imgur.com/3Bmg4Nd.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзк:\n\n╪з┘Д┘Д┘С┘░┘З┘П┘Е┘О┘С ╪е┘Р┘Ж┘О┘С╪з ┘Ж┘О╪│┘Т╪г┘О┘Д┘П┘Г┘О ╪з┘Д┘Т╪м┘О┘Ж┘О┘С╪й┘О ┘И┘О╪з┘Д┘Ж┘О┘С╪з╪▒┘Р ┘Ж┘О╪╣┘П┘И┘Т╪░┘П ╪и┘Р┘Г┘О ┘Е┘Р┘Ж┘О ╪з┘Д┘Ж┘О┘С╪з╪▒┘Р\n\nржЙржЪрзНржЪрж╛рж░ржг: 'ржЖрж▓рзНрж▓рж╛рж╣рзБржорзНржорж╛ ржЗржирзНржирж╛-ржирж╛рж╕ржЖрж▓рзБржХрж╛рж▓ ржЬрж╛ржирзНржирж╛рждрж╛ ржУрзЯрж╛ ржирж╛ржЙржЬрзБржмрж┐ржХрж╛ ржорж┐ржирж╛ржиржирж╛рж░ред'\n\nржЕрж░рзНрже: 'рж╣рзЗ ржЖрж▓рзНрж▓рж╛рж╣! ржЖржорж░рж╛ ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗ ржЬрж╛ржирзНржирж╛ржд ржЪрж╛ржЗ ржПржмржВ ржЬрж╛рж╣рж╛ржирзНржирж╛ржо ржерзЗржХрзЗ ржЖржкржирж╛рж░ ржЖрж╢рзНрж░ржпрж╝ ржЪрж╛ржЗред' ЁЯМЩ",
                    image: "https://i.imgur.com/TUm1LQW.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзл:\n\n╪з┘Д┘Д┘О┘С┘З┘П┘Е┘О┘С ┘В┘Р┘Ж┘Р┘К ╪╣┘О╪░┘О╪з╪и┘О┘Г┘О ┘К┘О┘И┘Т┘Е┘О ╪к┘О╪и┘Т╪╣┘О╪л┘П ╪╣┘Р╪и┘О╪з╪п┘О┘Г┘О\n\nржЙржЪрзНржЪрж╛рж░ржг: 'ржЖрж▓рзНрж▓рж╛рж╣рзБржорзНржорж╛ ржХрзНржмрж┐ржирж┐ ржЖржЬрж╛ржмрж╛ржХрж╛ ржЗрзЯрж╛ржУржорж╛ рждрж╛ржмржЖржЫрзБ ржЗржмрж╛ржжрж╛ржХрж╛ред'\n\nржЕрж░рзНрже: 'рж╣рзЗ ржЖрж▓рзНрж▓рж╛рж╣! ржпрзЗржжрж┐ржи рждрзБржорж┐ рждрзЛржорж╛рж░ ржмрж╛ржирзНржжрж╛ржжрзЗрж░ ржкрзБржирж░рзБрждрзНржерж┐ржд ржХрж░ржмрзЗ, рж╕рзЗржжрж┐ржи ржЖржорж╛ржХрзЗ рждрзЛржорж╛рж░ рж╢рж╛рж╕рзНрждрж┐ ржерзЗржХрзЗ рж░ржХрзНрж╖рж╛ ржХрж░рзЛ█Ф' тШАя╕П",
                    image: "https://i.imgur.com/wp7hM0m.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзм:\n\n╪▒┘О╪и┘О┘С┘Ж┘О╪з█д ╪з┘░┘Е┘О┘Ж┘О┘С╪з ┘Б┘О╪з╪║█б┘Б┘Р╪▒█б ┘Д┘О┘Ж┘О╪з ┘И┘О ╪з╪▒█б╪н┘О┘Е█б┘Ж┘О╪з ┘И┘О ╪з┘О┘Ж█б╪к┘О ╪о┘О█М█б╪▒┘П ╪з┘Д╪▒┘С┘░╪н┘Р┘Е┘Р█М█б┘Ж┘О\n\nржЙржЪрзНржЪрж╛рж░ржг: 'рж░рж╛ржмрзНржмрж╛ржирж╛ ржЖржорж╛ржирзНржирж╛ ржлрж╛ржЧржлрж┐рж░рж▓рж╛ржирж╛ ржУрзЯрж╛рж░рж╣рж╛ржоржирж╛ ржУрзЯрж╛ ржЖржВрждрж╛ ржЦрж╛ржЗрж░рзБрж░ рж░рж╛рж╣рж┐ржорж┐ржиред'\n\nржЕрж░рзНрже: 'рж╣рзЗ ржЖржорж╛ржжрзЗрж░ ржкрзНрж░рждрж┐ржкрж╛рж▓ржХ! ржЖржорж░рж╛ ржИржорж╛ржи ржПржирзЗржЫрж┐, ржЕрждржПржм ржЖржорж╛ржжрзЗрж░ржХрзЗ ржХрзНрж╖ржорж╛ ржХрж░рзБржи ржУ ржЖржорж╛ржжрзЗрж░ ржкрзНрж░рждрж┐ ржжрзЯрж╛ ржХрж░рзБржи ржПржмржВ ржЖржкржирж┐ ржжрзЯрж╛рж▓рзБржжрзЗрж░ ржоржзрзНржпрзЗ рж╕рж░рзНржмрзЛрждрзНрждржо ржжрзЯрж╛рж▓рзБред' ЁЯМ║",
                    image: "https://i.imgur.com/pFvUmsm.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзн:\n\nрж░рж╛ржмрзНржмрж╛ржирж╛- ржУрзЯрж╛рж▓рж╛- рждрзБрж╣рж╛ржорзНржорж┐рж▓ржирж╛- ржорж╛-рж▓рж╛- рждрзНржмрж╛-ржХрзНржмрж╛рждрж╛ рж▓рж╛ржирж╛- ржмрж┐рж╣рзА, ржУрзЯрж╛'ржлрзБ 'ржЖржирзНржирж╛- ржУрзЯрж╛ржЧржлрж┐рж░ рж▓рж╛ржирж╛- ржУрзЯрж╛рж░╪н┘О┘Е┘Ж╪з█Ф'\n\nржЕрж░рзНрже: 'рж╣рзЗ ржЖржорж╛ржжрзЗрж░ ржкрзНрж░рждрж┐ржкрж╛рж▓ржХ! ржЖржорж╛ржжрзЗрж░ржХрзЗ ржПржоржи ржмрзЛржЭрж╛ ржмрж╣ржи ржХрж░рж╛ржмрзЗржи ржирж╛, ржпрж╛ ржЖржорж╛ржжрзЗрж░ рж╕рж╛ржзрзНржпрж╛рждрзАрждред ржЖрж░ ржЖржорж╛ржжрзЗрж░ ржХрзНрж╖ржорж╛ ржХрж░рзБржи, ржЖржорж╛ржжрзЗрж░ ржкрж╛ржк ржорзЛржЪржи ржХрж░рзБржи ржУ ржЖржорж╛ржжрзЗрж░ ржкрзНрж░рждрж┐ ржжрзЯрж╛ ржХрж░рзБржиред' ЁЯМ╕",
                    image: "https://i.imgur.com/LH2qVcm.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзо:\n\n╪▒┘О╪и┘Р┘С ┘З┘О╪и┘Т ┘Д┘Р┘К ┘Е┘Р┘Ж┘О ╪з┘Д╪╡┘О┘С╪з┘Д┘Р╪н┘Р┘К┘Ж┘О\n\nржЙржЪрзНржЪрж╛рж░ржг: 'рж░рж╛ржмрзНржмрж┐ рж╣рж╛ржм рж▓рзА ржорж┐ржирж╛рж╕ рж╕рж▓рж┐рж╣рзАржиред'\n\nржЕрж░рзНрже: 'рж╣рзЗ ржЖржорж╛рж░ ржкрзНрж░рждрж┐ржкрж╛рж▓ржХ! ржЖржорж╛ржХрзЗ рж╕рзОржХрж░рзНржорж╢рзАрж▓ рж╕ржирзНрждрж╛ржи ржжрж╛ржи ржХрж░рзБржиред' ЁЯМЯ",
                    image: "https://i.imgur.com/28Et6s2.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рзп:\n\nржХржмрж░ ржЬрж┐рзЯрж╛рж░рждрзЗрж░ ржжрзЛржпрж╝рж╛:\n\n╪з┘Д╪│┘Д╪з┘Е ╪╣┘Д┘К┘Г┘Е ╪п╪з╪▒ ┘В┘И┘Е ┘Е╪д┘Е┘Ж┘К┘Ж ┘И╪е┘Ж╪з ╪е┘Ж ╪┤╪з╪б ╪з┘Д┘Д┘З ╪и┘Г┘Е ┘Д╪з╪н┘В┘И┘Ж\n\nржЙржЪрзНржЪрж╛рж░ржг: 'ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо ржжрж╛рж░рж╛ ржХрж╛ржУржорж┐ржи ржорзБ'ржорж┐ржирж┐ржирж╛, ржУржпрж╝рж╛ ржЗржирзНржирж╛ ржЗржи рж╢рж╛ ржЖрж▓рзНрж▓рж╛рж╣рзБ ржмрж┐ржЖржХрзБржо рж▓рж╛рж╣рж┐ржХрзБржи█Ф'\n\nржЕрж░рзНрже: 'рж╢рж╛ржирзНрждрж┐ ржмрж░рзНрж╖рж┐ржд рж╣рзЛржХ ржЖржкржирж╛ржжрзЗрж░ ржЙржкрж░, рж╣рзЗ ржорзБржорж┐ржиржЧржгрзЗрж░ ржЖржмрж╛рж╕! ржЖрж░ ржирж┐рж╢рзНржЪржпрж╝ржЗ ржЖржорж░рж╛ ржЗржирж╢рж╛ржЖрж▓рзНрж▓рж╛рж╣ ржЖржкржирж╛ржжрзЗрж░ рж╕рж╛ржерзЗ ржорж┐рж▓рж┐ржд рж╣ржмред' ЁЯХМ",
                    image: "https://i.imgur.com/NIjfdfz.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рззрзж:\n\n╪▒┘О╪и┘Р┘С ┘З┘О╪и┘Т ┘Д┘Р┘К ┘Е┘Р┘Ж ┘Д┘О┘С╪п┘П┘Ж┘Т┘Г┘О ╪░┘П╪▒┘Р┘С┘К┘О┘С╪й┘Л ╪╖┘О┘К┘Р┘С╪и┘О╪й┘Л ╪е┘Р┘Ж┘О┘С┘Г┘О ╪│┘О┘Е┘Р┘К╪╣┘П ╪з┘Д╪п┘П┘С╪╣┘О╪з╪б\n\nржЙржЪрзНржЪрж╛рж░ржг: 'рж░рж╛ржмрзНржмрж┐ рж╣рж╛ржм рж▓рж┐ ржорж┐рж▓ рж▓рж╛ржжрзБржиржХрж╛ ржпрзБрж░рж░рж┐ржпрж╝рзНржпрж╛рждрж╛ржи рждрж╛ржпрж╝рзНржпрж┐ржмрж╛рждрж╛ржи ржЗржирзНржирж╛ржХрж╛ рж╕рж╛ржорзА'ржЙржж ржжрзБ'ржЖред'\n\nржЕрж░рзНрже: 'рж╣рзЗ ржЖржорж╛рж░ ржкрзНрж░рждрж┐ржкрж╛рж▓ржХ! ржЖржкржирж╛рж░ ржкржХрзНрж╖ ржерзЗржХрзЗ ржЖржорж╛ржХрзЗ ржкржмрж┐рждрзНрж░ рж╕ржирзНрждрж╛ржи ржжрж╛ржи ржХрж░рзБржиред ржирж┐рж╢рзНржЪржпрж╝ржЗ ржЖржкржирж┐ ржкрзНрж░рж╛рж░рзНржержирж╛ рж╢рзНрж░ржмржгржХрж╛рж░рзАред' ЁЯМ╖",
                    image: "https://i.imgur.com/1ufw46l.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рззрзз:\n\n╪з┘Д┘Д┘С┘░┘З┘П┘Е┘О┘С ╪е┘Р┘Ж┘Р┘С┘К┘Т ╪г┘О╪│┘Т╪г┘О┘Д┘П┘Г┘О ╪з┘Д┘Т┘З┘П╪п┘О┘Й ┘И┘О╪з┘Д╪к┘П┘С┘В┘О┘Й ┘И┘О╪з┘Д┘Т╪╣┘О┘Б┘О╪з┘Б┘О ┘И┘О╪з┘Д┘Т╪║┘Р┘Ж┘О┘Й\n\nржЙржЪрзНржЪрж╛рж░ржг: 'ржЖрж▓рзНрж▓рж╛рж╣рзБржорзНржорж╛ ржЗржирзНржирж┐ ржЖрж╕ржЖрж▓рзБржХрж╛рж▓ рж╣рзБржжрж╛ ржУржпрж╝рж╛ржд рждрзБржХрзНржмрж╛ ржУржпрж╝рж╛рж▓ ржЖржлрж╛ржлрж╛ ржУржпрж╝рж╛рж▓ ржЧрж┐ржирж╛█Ф'\n\nржЕрж░рзНрже: 'рж╣рзЗ ржЖрж▓рзНрж▓рж╛рж╣! ржЖржорж┐ ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗ рж╣рзЗржжрж╛ржпрж╝рзЗржд, рждрж╛ржХржУржпрж╝рж╛, ржкржмрж┐рждрзНрж░рждрж╛ ржУ рж╕ржЪрзНржЫрж▓рждрж╛ ржкрзНрж░рж╛рж░рзНржержирж╛ ржХрж░ржЫрж┐█Ф' ЁЯТл",
                    image: "https://i.imgur.com/0wcNcmI.jpeg"
                },
                {
                    text: "ЁЯУЦ ржжрзЛржпрж╝рж╛ рззрзи:\n\nржХржмрж░ ржЬрж┐ржпрж╝рж╛рж░рждрзЗрж░ ржкржжрзНржзрждрж┐:\n\nрзз. ржХржмрж░рзЗрж░ ржкрж╛рж╢рзЗ ржжрж╛ржБржбрж╝рж┐ржпрж╝рзЗ рж╕рж╛рж▓рж╛ржо ржжрж┐ржи\nрзи. рж╕рзВрж░рж╛ ржлрж╛рждрж┐рж╣рж╛ ржкрж╛ржа ржХрж░рзБржи\nрзй. рж╕рзВрж░рж╛ ржЗржЦрж▓рж╛рж╕, ржлрж╛рж▓рж╛ржХ ржУ ржирж╛рж╕ ржкрж╛ржа ржХрж░рзБржи\nрзк. ржорзГржд ржмрзНржпржХрзНрждрж┐рж░ ржЬржирзНржп ржжрзЛржпрж╝рж╛ ржХрж░рзБржи\nрзл. ржХржмрж░рзЗрж░ ржжрж┐ржХрзЗ ржкрж╛ ржирж╛ ржжрж┐ржпрж╝рзЗ рж╕ржорзНржорж╛ржирзЗрж░ рж╕рж╛ржерзЗ ржкрзНрж░рж╕рзНржерж╛ржи ржХрж░рзБржи\n\nЁЯХЛ ржЗрж╕рж▓рж╛ржорж┐ржХ ржмрж┐ржзрж╛ржи ржЕржирзБрж╕рж╛рж░рзЗ ржХржмрж░ ржЬрж┐ржпрж╝рж╛рж░ржд ржХрж░рж╛ ржорзБрж╕рзНрждрж╛рж╣рж╛ржмред",
                    image: "https://i.imgur.com/AnIgU1J.jpeg"
                }
            ];

            // Show menu if no number provided
            if (!args[0] || isNaN(args[0])) {
                const menuMessage = `
ЁЯХМ ржЗрж╕рж▓рж╛ржорж┐ржХ ржжрзЛржпрж╝рж╛рж░ рж╕ржВржЧрзНрж░рж╣ ЁЯХМ

ржирж┐ржЪрзЗрж░ рждрж╛рж▓рж┐ржХрж╛ ржерзЗржХрзЗ ржжрзЛржпрж╝рж╛ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рждрзЗ ржиржорзНржмрж░ рж▓рж┐ржЦрзБржи:

1я╕ПтГг.  ржХрзНрж╖ржорж╛ ржУ рж╕рзБрж░ржХрзНрж╖рж╛рж░ ржжрзЛржпрж╝рж╛ ЁЯЩП
2я╕ПтГг.  ржкрзВржгрзНржпржмрж╛ржи ржЬрзАржмржирж╕ржЩрзНржЧрзА ржУ рж╕ржирзНрждрж╛ржирзЗрж░ ржжрзЛржпрж╝рж╛ ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСж  
3я╕ПтГг.  рж╕рж╣ржмрж╛рж╕рзЗрж░ ржкрзВрж░рзНржмрзЗрж░ ржжрзЛржпрж╝рж╛ ЁЯТС
4я╕ПтГг.  ржЬрж╛рж╣рж╛ржирзНржирж╛ржо ржерзЗржХрзЗ рж╕рзБрж░ржХрзНрж╖рж╛рж░ ржжрзЛржпрж╝рж╛ ЁЯФе
5я╕ПтГг.  ржХрж┐ржпрж╝рж╛ржоржд ржжрж┐ржмрж╕рзЗрж░ рж╕рзБрж░ржХрзНрж╖рж╛рж░ ржжрзЛржпрж╝рж╛ ЁЯУЬ
6я╕ПтГг.  ржХрзНрж╖ржорж╛ ржУ рж░рж╣ржорждрзЗрж░ ржжрзЛржпрж╝рж╛ ЁЯМИ
7я╕ПтГг.  ржмрзЛржЭрж╛ рж╣рж╛рж▓ржХрж╛ ржХрж░рж╛рж░ ржжрзЛржпрж╝рж╛ ЁЯПЛя╕П
8я╕ПтГг.  рж╕рзО рж╕ржирзНрждрж╛ржи рж▓рж╛ржнрзЗрж░ ржжрзЛржпрж╝рж╛ ЁЯС╢
9я╕ПтГг.  ржХржмрж░ ржЬрж┐ржпрж╝рж╛рж░рждрзЗрж░ ржжрзЛржпрж╝рж╛ тЪ░я╕П
ЁЯФЯ.  ржкрзВржгрзНржпржмрж╛ржи рж╕ржирзНрждрж╛ржи рж▓рж╛ржнрзЗрж░ ржжрзЛржпрж╝рж╛ ЁЯзТ
1я╕ПтГг1я╕ПтГг. ржмрзНржпрж╛ржкржХ ржжрзЛржпрж╝рж╛ ЁЯМЯ
1я╕ПтГг2я╕ПтГг. ржХржмрж░ ржЬрж┐ржпрж╝рж╛рж░рждрзЗрж░ ржкржжрзНржзрждрж┐ ЁЯУ┐

ЁЯУЭ ржмрзНржпржмрж╣рж╛рж░: doya2 [ржиржорзНржмрж░] (ржЙржжрж╛рж╣рж░ржг: doya2 5)
`;

                // Auto-download all images in background when menu is shown
                this.preDownloadImages(doyaContent);
                
                return message.reply(menuMessage);
            }

            // Handle number selection
            const selection = parseInt(args[0]);
            if (selection < 1 || selection > doyaContent.length) {
                return message.reply(`тЭМ ржЕржмрзИржз ржирж┐рж░рзНржмрж╛ржЪржи! ржжржпрж╝рж╛ ржХрж░рзЗ рзз-${doyaContent.length} ржПрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ ржиржорзНржмрж░ рж▓рж┐ржЦрзБржиред`);
            }
            
            const doya = doyaContent[selection - 1];
            const cacheDir = path.join(__dirname, 'cache', 'doya_images');
            const imagePath = path.join(cacheDir, `doya_${selection}.jpeg`);
            
            try {
                console.log(`ЁЯЦ╝я╕П Attempting to send image for doya #${selection}`);
                
                // Check if image already exists in cache
                if (fs.existsSync(imagePath)) {
                    console.log(`тЬЕ Image already exists in cache, sending...`);
                    
                    // Send cached image
                    await message.reply({
                        body: doya.text,
                        attachment: fs.createReadStream(imagePath)
                    });
                    
                    console.log(`тЬЕ Successfully sent cached image for doya #${selection}`);
                    
                } else {
                    console.log(`ЁЯУе Downloading image for doya #${selection}...`);
                    
                    // Download the image immediately
                    const loadingMsg = await message.reply(`ЁЯУе ржжрзЛржпрж╝рж╛ ${selection} ржПрж░ ржЫржмрж┐ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ...\n\nтП│ ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзБржи...`);
                    
                    const response = await axios({
                        method: 'GET',
                        url: doya.image,
                        responseType: 'stream',
                        timeout: 30000,
                        headers: {
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                        }
                    });

                    // Create write stream
                    const writer = fs.createWriteStream(imagePath);
                    
                    response.data.pipe(writer);
                    
                    await new Promise((resolve, reject) => {
                        writer.on('finish', resolve);
                        writer.on('error', reject);
                    });

                    console.log(`тЬЕ Successfully downloaded image for doya #${selection}`);
                    
                    // Delete loading message
                    try {
                        await message.unsendMessage(loadingMsg.messageID);
                    } catch (e) {
                        console.log("тД╣я╕П Could not delete loading message");
                    }
                    
                    // Send the downloaded image
                    await message.reply({
                        body: doya.text,
                        attachment: fs.createReadStream(imagePath)
                    });
                    
                    console.log(`тЬЕ Successfully sent downloaded image for doya #${selection}`);
                }
                
            } catch (imageError) {
                console.error("тЭМ Image error:", imageError);
                
                // Clean up failed download
                try {
                    if (fs.existsSync(imagePath)) {
                        fs.unlinkSync(imagePath);
                    }
                } catch (cleanupError) {
                    console.log("тД╣я╕П Could not clean up failed download");
                }
                
                // Final fallback - send text only
                await message.reply(`${doya.text}\n\nтЪая╕П ржЫржмрж┐ ржкрзНрж░ржжрж░рзНрж╢ржирзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржЪрзНржЫрзЗ, рж╢рзБржзрзБ ржкрж╛ржарзНржп ржжрзЗржЦрж╛ржирзЛ рж╣ржЪрзНржЫрзЗ`);
            }

        } catch (error) {
            console.error("ржжрзЛржпрж╝рж╛ рж▓рзЛржб ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛:", error);
            await message.reply("тЭМ ржжрзЛржпрж╝рж╛ рж▓рзЛржб ржХрж░рждрзЗ ржмрзНржпрж░рзНрже рж╣ржпрж╝рзЗржЫрзЗред ржкрж░рзЗ ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред");
        }
    },

    // Auto-download all images in background
    preDownloadImages: async function(doyaContent) {
        try {
            const cacheDir = path.join(__dirname, 'cache', 'doya_images');
            
            console.log("ЁЯФД Starting auto-download of all images...");
            
            for (let i = 0; i < doyaContent.length; i++) {
                const imagePath = path.join(cacheDir, `doya_${i + 1}.jpeg`);
                
                // Skip if already downloaded
                if (fs.existsSync(imagePath)) {
                    console.log(`тЬЕ Image ${i + 1} already exists`);
                    continue;
                }
                
                try {
                    console.log(`ЁЯУе Auto-downloading image ${i + 1}...`);
                    
                    const response = await axios({
                        method: 'GET',
                        url: doyaContent[i].image,
                        responseType: 'stream',
                        timeout: 30000,
                        headers: {
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                        }
                    });

                    const writer = fs.createWriteStream(imagePath);
                    response.data.pipe(writer);
                    
                    await new Promise((resolve, reject) => {
                        writer.on('finish', resolve);
                        writer.on('error', reject);
                    });
                    
                    console.log(`тЬЕ Successfully auto-downloaded image ${i + 1}`);
                    
                } catch (downloadError) {
                    console.error(`тЭМ Failed to auto-download image ${i + 1}:`, downloadError.message);
                }
            }
            
            console.log("ЁЯОп Auto-download completed");
            
        } catch (error) {
            console.error("ЁЯТе Auto-download error:", error);
        }
    }
};
