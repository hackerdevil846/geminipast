const fs = require('fs-extra');
const path = require('path');

module.exports = {
  config: {
    name: "banglarhyme",
    aliases: ["banglapoem", "bnrhyme"],
    version: "1.0.0",
    author: "ЁЭР┤ЁЭСаЁЭСЦЁЭСУ ЁЭСАЁЭСОтДОЁЭСЪЁЭСвЁЭСС",
    role: 0,
    category: "fun",
    shortDescription: {
      en: "ЁЯУЭ ЁЭР╡ЁЭСОЁЭСЫЁЭСФЁЭСЩЁЭСО ЁЭСЯтДОЁЭСжЁЭСЪЁЭСТЁЭСа ЁЭСОЁЭСЫЁЭСС ЁЭСЭЁЭСЬЁЭСТЁЭСЪЁЭСа"
    },
    longDescription: {
      en: "ЁЭР║ЁЭСТЁЭСЫЁЭСТЁЭСЯЁЭСОЁЭСбЁЭСТ ЁЭСПЁЭСТЁЭСОЁЭСвЁЭСбЁЭСЦЁЭСУЁЭСвЁЭСЩ ЁЭР╡ЁЭСОЁЭСЫЁЭСФЁЭСЩЁЭСО ЁЭСЯтДОЁЭСжЁЭСЪЁЭСТЁЭСа ЁЭСОЁЭСЫЁЭСС ЁЭСЭЁЭСЬЁЭСТЁЭСЪЁЭСа"
    },
    guide: {
      en: "{p}banglarhyme"
    },
    countDown: 5,
    dependencies: {
      "fs-extra": ""
    }
  },

  onStart: async function ({ message }) {
    try {
      const jsonPath = path.join(__dirname, 'data', 'pantun.json');
      
      // Backup rhymes array in case JSON file doesn't exist or is empty
      const backupRhymes = [
  "ЁЯМ╣ ржлрзБрж▓ ржлрзБржЯрзЗржЫрзЗ ржмрж╛ржЧрж╛ржирзЗ,\nрждрзЛржорж╛рж░ ржорждрзЛ рж╕рзБржирзНржжрж░ ржХрзЗржЙ ржирзЗржЗ ржнрзБржмржирзЗ",
  "тнР рждрж╛рж░рж╛ ржнрж░рж╛ рж░рж╛рждрзЗрж░ ржЖржХрж╛рж╢,\nрждрзЛржорж╛рж░ рж╣рж╛рж╕рж┐рждрзЗ ржЖржорж╛рж░ ржоржи рж╣ржпрж╝ ржЙрж▓рзНрж▓рж╛рж╕",
  "тШХ ржЪрж╛ржпрж╝рзЗрж░ ржХрж╛ржкрзЗ ржзрзЛржБржпрж╝рж╛ ржЙржарзЗ,\nрждрзЛржорж╛рж░ ржХржерж╛ ржнрзЗржмрзЗ ржоржиржЯрж╛ ржЫрзБржЯрзЗ",
  "ЁЯМЩ ржЪрж╛ржБржжржирзА рж░рж╛рждрзЗ ржЬрзЛржЫржирж╛ ржкржбрж╝рзЗ,\nрждрзЛржорж╛рж░ рж╕рж╛ржерзЗ ржХржерж╛ ржмрж▓рждрзЗ ржЗржЪрзНржЫрж╛ ржХрж░рзЗ",
  "ЁЯжЛ ржкрзНрж░ржЬрж╛ржкрждрж┐ ржУржбрж╝рзЗ ржмрж╛ржЧрж╛ржирзЗ,\nрждрзЛржорж╛рж░ ржорзЗрж╕рзЗржЬрзЗрж░ ржЬржирзНржп ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзЗ ржкрзНрж░рж╛ржгрзЗ",
  "ЁЯМзя╕П ржмрзГрж╖рзНржЯрж┐рждрзЗ ржнрж┐ржЬрзЗ ржпрж╛ржпрж╝ ржкрже,\nрждрзЛржорж╛рж░ рж╕рзНржорзГрждрж┐рждрзЗ ржнрж┐ржЬрзЗ ржпрж╛ржпрж╝ ржоржи",
  "ЁЯУЪ ржмржЗржпрж╝рзЗрж░ ржкрж╛рждрж╛ржпрж╝ ржЧрж▓рзНржк ржЖржЫрзЗ,\nрждрзЛржорж╛рж░ рж╕рж╛ржерзЗ ржЖржорж╛рж░ ржПржХржЯрж╛ рж╕ржорзНржкрж░рзНржХ рж╣ржмрзЗ",
  "ЁЯО╡ ржЧрж┐ржЯрж╛рж░ржпрж╝рзЗ рж╕рзБрж░ ржмрж╛ржЬрзЗ,\nрждрзЛржорж╛рж░ ржХржерж╛ рж╢рзБржирждрзЗ ржоржиржЯрж╛ ржЖржЬ ржХрж╛ржБржЬрзЗ",
  "ЁЯМЕ рж╕рзВрж░рзНржп ржУржарзЗ ржкрзБржм ржжрж┐ржХрзЗ,\nрждрзЛржорж╛рж░ ржжрзЗржЦрж╛ ржкрзЗрждрзЗ ржЪрзЛржЦ ржерж╛ржХрзЗ ржкржерзЗ",
  "ЁЯХКя╕П ржШрзБржШрзБ ржбрж╛ржХрзЗ ржЖржорзНрж░ржХрж╛ржиржирзЗ,\nрждрзЛржорж╛рж░ ржмрж╛рж░рзНрждрж╛ ржкрзЗрждрзЗ ржоржи ржмрзНржпрж╛ржХрзБрж▓ рж╣ржпрж╝ ржоржирзЗ",
  "ЁЯМ╕ ржмрж╕ржирзНрждрзЗ ржЖржорзЗрж░ ржорзБржХрзБрж▓,\nрждрзЛржорж╛рж░ рж╣рж╛рж╕рж┐ ржЖржорж╛рж░ ржоржирзЗ ржХрж░рзЗ ржжрзБрж▓",
  "тШАя╕П рж░рзЛржжрзЗрж▓рж╛ ржжрж┐ржирзЗ ржЫрж╛ржпрж╝рж╛ ржЦрзЛржБржЬрзЗ,\nрждрзЛржорж╛рж░ ржХржерж╛ ржнрзЗржмрзЗ ржоржиржЯрж╛ ржпрзЗ ржХрзЛржерж╛ржпрж╝ ржнрзЛржБржЬрзЗ",
  "ЁЯМК ржиржжрзАрж░ ржЬрж▓ ржпрж╛ржпрж╝ ржмржпрж╝рзЗ,\nрждрзЛржорж╛рж░ рж╕рж╛ржерзЗ рж╕ржоржпрж╝ ржпрж╛ржпрж╝ рж╣рзЗрж▓рзЗ",
  "ЁЯНГ ржкрж╛рждрж╛рж░ ржорж░рзНржорж░ рж╢ржмрзНржж,\nрждрзЛржорж╛рж░ ржХржгрзНржарж╕рзНржмрж░ ржЖржорж╛рж░ ржкрзНрж░рж┐ржпрж╝ рж╕ржмрзНржж",
  "ЁЯО╢ radioрждрзЗ ржЧрж╛ржи ржмрж╛ржЬрзЗ,\nрждрзЛржорж╛рж░ рж╕рзНржорзГрждрж┐ ржоржирзЗ ржЖржЬржУ ржпрзЗ ржнрж╛ржЬрзЗ",
  "ЁЯМ╗ рж╕рзВрж░рзНржпржорзБржЦрзА ржлрзБрж▓ рж╣рж╛рж╕рзЗ,\nрждрзЛржорж╛рж░ ржорждрзЛ рж╕рзБржирзНржжрж░ ржХрзЗржЙ ржирж╛ ржЖрж╕рзЗ",
  "ЁЯЫ╢ ржирзМржХрж╛ ржнрж╛рж╕рзЗ ржиржжрзА ржЬрзБржбрж╝рзЗ,\nрждрзЛржорж╛рж░ ржнрж╛рж▓рзЛржмрж╛рж╕рж╛ ржЫржбрж╝рж╛ржпрж╝ ржкрзБрж░рзЗ",
  "ЁЯУ▒ phoneржЯрж╛ ржЪрзЗржХ ржХрж░рж┐ ржмрж╛рж░ржмрж╛рж░,\nрждрзЛржорж╛рж░ message ржкрзЗрждрзЗ ржоржи ржЕрж╕рзНржерж┐рж░ ржЖрж░",
  "ЁЯМД ржнрзЛрж░рзЗрж░ ржЖрж▓рзЛржпрж╝ ржЭрж┐рж▓ржорж┐рж▓,\nрждрзЛржорж╛рж░ ржЪрзЛржЦрзЗ ржжрзЗржЦрж┐ ржПржХржЯрж╛ ржкрж░рж┐рж▓",
  "ЁЯНВ рж╢рж░рждрзЗ рж╢рж┐ржЙрж▓рж┐ ржЭрж░рзЗ,\nрждрзЛржорж╛рж░ ржЬржирзНржп ржоржиржЯрж╛ ржХрж░рзЗ ржнрж░рзЗ",
  "ЁЯОи canvasржпрж╝рзЗ рж░ржВ рж▓рж╛ржЧрж╛ржЗ,\nрждрзЛржорж╛рж░ ржорждрзЛ рж╕рзБржирзНржжрж░ ржЫржмрж┐ ржЖржБржХрж╛ржЗ",
  "ЁЯМГ рж░рж╛рждрзЗрж░ рждрж╛рж░рж╛ ржЯрзБржЯрж┐ ржЯрзБржЯрж┐,\nрждрзЛржорж╛рж░ ржХржерж╛ ржнрж╛ржмрж┐ ржЖржорж┐ ржжрзБржЯрж┐",
  "ЁЯк╖ ржкржжрзНржо ржлрзБрж▓рзЗ ржнрзНрж░ржорж░ ржЖрж╕рзЗ,\nрждрзЛржорж╛рж░ ржорзЗрж╕рзЗржЬрзЗ ржоржиржЯрж╛ ржпрзЗ ржнрж╛рж╕рзЗ",
  "ЁЯУЦ diaryрждрзЗ рж▓рж┐ржЦрж┐ ржирж╛ржо,\nрждрзЛржорж╛рж░ рж╕рж╛ржерзЗ ржХрж╛ржЯрж╛ржЗ рж╕ржм ржЖржо",
  "ЁЯМЙ bridge ржкрж╛рж░ рж╣ржпрж╝рзЗ ржпрж╛ржЗ,\nрждрзЛржорж╛рж░ ржХржерж╛ ржнрзЗржмрзЗ рж╣рж╛рж╕рж┐ рждрж╛ржЗ",
  "ЁЯлЦ ржЪрж╛ржпрж╝рзЗрж░ ржжрзЛржХрж╛ржирзЗ ржмрж╕рзЗ,\nрждрзЛржорж╛рж░ SMS ржПрж░ ржЬржирзНржп ржоржиржЯрж╛ ржпрзЗ рж░рж╕рзЗ",
  "ЁЯОн stageржпрж╝рзЗ ржирж╛ржЪ ржжрзЗржЦрж┐,\nрждрзЛржорж╛рж░ ржорждрзЛ ржирж╛ржЪрзЗ ржХрзЗржЙ ржирж╛ржЪрж┐",
  "ЁЯМБ ржХрзБржпрж╝рж╛рж╢рж╛ржпрж╝ ржврж╛ржХрж╛ ржкрж╛рж╣рж╛ржбрж╝,\nрждрзЛржорж╛рж░ ржнрж╛рж▓рзЛржмрж╛рж╕рж╛ ржЖржорж╛рж░ ржЕрж╣ржВржХрж╛рж░",
  "ЁЯУ╕ photo рждрзЛрж▓рж┐ ржХрзНржпрж╛ржорзЗрж░рж╛ржпрж╝,\nрждрзЛржорж╛рж░ ржЫржмрж┐ ржерж╛ржХрж▓рзЗ рж╕рзЗржЯрж┐ ржзрж░рзЗ рж░рж╛ржЦрж┐ рж╣рзГржжржпрж╝",
  "ЁЯО╣ pianoржпрж╝ рж╕рзБрж░ рждрзБрж▓рж┐,\nрждрзЛржорж╛рж░ ржЬржирзНржп ржЧрж╛ржи ржЧрзЗржпрж╝рзЗ ржмрж▓рж┐"
];

      let rhymes = [];

      // Try to read from JSON file first
      if (fs.existsSync(jsonPath)) {
        try {
          const jsonData = await fs.readJson(jsonPath);
          rhymes = jsonData.banglaRhymes || [];
        } catch (jsonError) {
          console.error("Error reading JSON file:", jsonError);
        }
      }

      // If no rhymes from JSON file, use backup
      if (rhymes.length === 0) {
        rhymes = backupRhymes;
      }

      // Select a random rhyme
      const randomRhyme = rhymes[Math.floor(Math.random() * rhymes.length)];

      // Send the rhyme
      await message.reply(randomRhyme);

    } catch (err) {
      console.error("Bangla rhyme command error:", err);
      message.reply("тЭМ ЁЭР┤ЁЭСЫ ЁЭСТЁЭСЯЁЭСЯЁЭСЬЁЭСЯ ЁЭСЬЁЭСРЁЭСРЁЭСвЁЭСЯЁЭСЯЁЭСТЁЭСС ЁЭСдтДОЁЭСЦЁЭСЩЁЭСТ ЁЭСУЁЭСТЁЭСбЁЭСРтДОЁЭСЦЁЭСЫЁЭСФ ЁЭСбтДОЁЭСТ ЁЭСЯтДОЁЭСжЁЭСЪЁЭСТ.");
    }
  }
};
